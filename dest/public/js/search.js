function pageInit(){bannerBox=$(".index-banner").find(".swiper-wrapper"),bannerSlide=bannerBox.find(".swiper-slide").clone(!1),indexGoodsBox=$(".index-goods-list"),indexGoodsLi=indexGoodsBox.find("li").clone(!1),searchGoodsBox=$(".search-list"),searchGoodsLi=searchGoodsBox.find("li").clone(!1),getGoodsData(),$(".search-bar").find("input").change(function(){var o=$(this).val();o||$(".index-search").removeClass("show")}),$(".search-btn").click(function(){var o=waiting("正在搜索"),e=$(".search-bar").find("input").val();$.ajax({url:"http://datainfo.duapp.com/shopdata/selectGoodes.php",type:"post",dataType:"JSONP",data:"selectText="+e,success:function(e){if(o(),console.log(e),0==e){$(".search-list").css("display","none"),$(".index-search").find("p").remove();var n=$("<p>没有找到相关商品</p>");$(".index-search").append(n)}else $(".search-list").css("display","block"),$(".index-search").find("p").remove(),loadSearchList(e);$(".index-search").addClass("show")}})})}function getGoodsData(){var o=waiting("正在加载页面"),e=!1,n=!1;$.ajax({url:"http://datainfo.duapp.com/shopdata/getGoods.php",type:"post",dataType:"JSONP",success:function(a){loadIndexList(a),n=!0,e&&o()}}),$.ajax({url:"http://datainfo.duapp.com/shopdata/getBanner.php",type:"post",dataType:"JSONP",success:function(a){loadBanner(a),e=!0,n&&o()}})}function loadBanner(o){bannerBox.empty();for(var e in o){var n=bannerSlide.clone(!1),a=o[e].goodsID,t=JSON.parse(o[e].goodsBenUrl)[0];n.find("a").attr("data-goodsID",a),n.find("img").attr("src",t),bannerBox.append(n)}new Swiper(".swiper-container",{autoplay:3e3,loop:!0});console.log(o)}function loadIndexList(o){indexGoodsBox.empty();for(var e in o){var n=indexGoodsLi.clone(!1),a=o[e].goodsListImg,t=o[e].goodsName,s=1*o[e].price,d=1*o[e].discount,i=s,r=o[e].goodsID;n.find(".discount").find("span").text(d),0!=d&&(d/=10,i=s/d),i=i.toFixed(2),n.find("img").attr("src",a),n.find(".goods-name").text(t),n.find(".price-box").find("span").text("¥"+s),n.find(".price-box").find("del").text("¥"+i);var c=$('<a class="iconfont icon-gouwuche"></a>');n.find(".content-box").append(c),n.find(".content-box").find("a").attr("data-type-ID",r),n.attr("data-goodsID",r),n.find("img").click(function(){var o=$(this).closest("li").attr("data-goodsID");sessionStorage.setItem("goodsID",o),location.href="goodscontent.html"}),n.find(".goods-name").click(function(){var o=$(this).closest("li").attr("data-goodsID");sessionStorage.setItem("goodsID",o),location.href="goodscontent.html"}),n.find(".content-box").find("a").click(function(){var o=$(this).attr("data-type-ID");sessionStorage.setItem("goods-ID",o),_goodsID=sessionStorage.getItem("goods-ID");sessionStorage.getItem("loginName");addShopCar({userID:"loginName",goodsID:_goodsID,number:1})}),indexGoodsBox.append(n)}}function loadSearchList(o){searchGoodsBox.empty();for(var e in o){var n=searchGoodsLi.clone(!1),a=o[e].goodsID,t=o[e].goodsListImg,s=o[e].goodsName,d=1*o[e].price,i=1*o[e].discount,r=d;0!=i&&(i/=10,r=d/i),r=r.toFixed(2),n.find("img").attr("src",t),n.find(".goods-name").text(s),n.find(".price-box").find("span").text("¥"+d),n.find(".price-box").find("del").text("¥"+r),n.find(".discount").find("span").text(i),n.attr("data-goodsID",a),n.click(function(){var o=$(this).attr("data-goodsID");sessionStorage.setItem("goodsID",o),location.href="goodscontent.html"}),searchGoodsBox.append(n)}}var bannerBox,bannerSlide,indexGoodsBox,indexGoodsLi,searchGoodsBox,searchGoodsLi;pageInit();