function getPageInit(){navBox={l:$(".goods-class.landscape").find("ul"),p:$(".goods-class.portrait").find("ul")},navList={l:navBox.l.find("li").clone(!1),p:navBox.p.find("li").clone(!1)},goodsBox=$(".goods-list"),goodsList=goodsBox.find("li").clone(!1),goodsDataBuff=[],loadClassNav(),loadGoodsList(),$(".page-btn").click(function(){var o=$(this).attr("data-type");switch(o){case"back":0!=onGoodsObj.pageCode&&(onGoodsObj.pageCode--,loadGoodsList(onGoodsObj));break;case"next":onGoodsObj.pageCode++,loadGoodsList(onGoodsObj)}})}function loadClassNav(){$.get("http://datainfo.duapp.com/shopdata/getclass.php",function(o){o=JSON.parse(o),navBox.l.empty(),navBox.p.empty();for(var a in o){var s={l:navList.l.clone(!1),p:navList.p.clone(!1)};s.l.find(".iconfont").html(o[a].icon),s.l.find(".class-name").text(o[a].className),s.l.attr("data-classID",o[a].classID),s.p.find(".iconfont").html(o[a].icon),s.p.attr("data-classID",o[a].classID),navBox.l.append(s.l),navBox.p.append(s.p)}$(".goods-class").find("li").click(function(){var o=$(this).attr("data-classID");loadGoodsList({classID:o,pageCode:0}),$(".goods-class").find(".active").removeClass("active"),$(".goods-class").find("li[data-classID='"+o+"']").addClass("active")});var t=o.length;navBox.p.width(.57*t+"rem")})}function loadGoodsList(o){var a="";if(o)o.classID?a="classID="+o.classID+"&":o.classID=0,0!=o.pageCode&&o.pageCode?a="pageCode="+o.pageCode+"&":(a="pageCode=0&",o.pageCode=0);else var o={classID:0,pageCode:0};for(var s in goodsDataBuff)if(goodsDataBuff[s].classID==o.classID){var t=null;for(var d in goodsDataBuff[s].goodsList)goodsDataBuff[s].goodsList[d].pageCode==o.pageCode&&(t=goodsDataBuff[s].goodsList[d].dataList);return t?(addGoodsData(t),void(onGoodsObj=o)):void addBuff(o,function(){loadGoodsList(o)})}addBuff(o,function(){loadGoodsList(o)})}function addGoodsData(o){goodsBox.empty();for(var a in o){var s=goodsList.clone(!1),t=o[a].goodsListImg,d=o[a].goodsName,e=1*o[a].price,n=o[a].discount/10,i=e,c=o[a].goodsID;0!=n&&(i=e/(o[a].discount/10)),i=i.toFixed(2),s.find("img").attr("src",t),s.find(".goods-name").text(d),s.find(".text").find("span").text("¥ "+e),s.find(".text").find("del").text("¥ "+i),s.attr("data-goodsID",c),goodsBox.append(s),s.click(function(){var o=$(this).attr("data-goodsID");sessionStorage.setItem("goodsID",o),location.href="goodscontent.html"})}}function addBuff(o,a){var s="";if(o)o.classID?s="classID="+o.classID+"&":o.classID=0,0!=o.pageCode?s=s+"pageCode="+o.pageCode+"&":(s+="pageCode=0&",o.pageCode=0);else var o={classID:0,pageCode:0};$.ajax({url:"http://datainfo.duapp.com/shopdata/getGoods.php",type:"post",data:s,dataType:"JSONP",success:function(s){if(0!=s){for(var t in goodsDataBuff)if(goodsDataBuff[t].classID==o.classID){var d={pageCode:o.pageCode,dataList:s};return goodsDataBuff[t].goodsList.push(d),void(a&&a())}var e={classID:o.classID,goodsList:[{pageCode:o.pageCode,dataList:s}]};goodsDataBuff.push(e),a&&a()}else onGoodsObj.pageCode--}})}function goPage(o){}function touche(){var o,a,s=$("article");s.on("touchstart",function(t){s.removeClass("anm"),o=t.originalEvent.targetTouches[0].pageX,a=t.originalEvent.targetTouches[0].pageY}),s.on("touchmove",function(t){mX=t.originalEvent.targetTouches[0].pageX-o,mY=t.originalEvent.targetTouches[0].pageY-a;var d=-mX,e=1.2;Math.abs(mX)>4*Math.abs(mY)&&(mX>0?Math.abs(mX)<150?($(".text.left").find(".iconfont").css("transform","rotate("+d*e+"deg)"),s.css("transform","translateX("+mX+"px)")):(s.trigger("touchend"),goPage(mX)):Math.abs(mX)<150?($(".text.right").find(".iconfont").css("transform","rotate("+d*e+"deg)"),s.css("transform","translateX("+mX+"px)")):(s.trigger("touched"),goPage(mX)))}),s.on("touchend",function(o){s.addClass("anm"),s.css("transform","translateX(0px)")})}getPageInit();var navBox,navList,goodsBox,goodsList,goodsDataBuff,onGoodsObj={classID:0,pageCode:0};touche();