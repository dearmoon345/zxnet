function pageInit(){carBox=$(".car-box"),carList=carBox.find("li").clone(!1),loginName=sessionStorage.getItem("loginName"),gd=sessionStorage.getItem("goodsID"),addShopCar({userID:loginName,goodsID:gd,number:1}),loginName?getCarGoods(loginName):show("您尚未登录,请登录后再试!"),$(".car-box").on("click",".number-btn",function(){var a=$(this).attr("data-type"),t=1*$(this).closest("li").find("input").val();switch(a){case"add":t++;break;case"minus":t--,t<=1&&(t=1)}$(this).closest("li").find("input").val(t),clearTimeout(userAction),updateCountInfo(),userAction=setTimeout(function(){console.log("发送请求"),updataPage()},1e3)}),$(".car-box").on("click",".remove-btn",function(){var a=$(this).closest("li").attr("data-goodsID");addShopCar({userID:loginName,goodsID:a,number:0}),$(this).closest("li").remove(),clearTimeout(userAction),updateCountInfo(),userAction=setTimeout(function(){console.log("发送请求"),updataPage()},1e3)})}function updataPage(){var a=carBox.find("li");a.each(function(){var a=$(this).attr("data-goodsID"),t=1*$(this).find("input").val(),o={userID:loginName,goodsID:a,number:t};addShopCar(o)})}function getCarGoods(a){$.ajax({url:"http://datainfo.duapp.com/shopdata/getCar.php",type:"post",data:"userID="+a,dataType:"JSONP",success:function(a){0==a||addPageData(a)}})}function addPageData(a){carBox.empty();for(var t in a){var o=carList.clone(!1),n=a[t].goodsListImg,e=a[t].goodsName,i=1*a[t].price,s=1*a[t].number;o.find("img").attr("src",n),o.find(".goods-name").text(e),o.find(".price").find("i").text(i),o.find("input").val(s),o.attr("data-goodsID",a[t].goodsID),carBox.append(o)}updateCountInfo()}function updateCountInfo(){var a=carBox.find("li"),t=0,o=0;a.each(function(){var a=1*$(this).find("input").val(),n=1*$(this).find(".price").find("i").text();t+=a,o+=a*n}),o=o.toFixed(2),$(".car-data-box").find(".number").text(t),$(".car-data-box").find(".count").text(o)}var carBox,carList,loginName=null,userAction;pageInit();